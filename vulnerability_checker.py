import requests
from bs4 import BeautifulSoup

def check_vulnerability(service_name, version):
    """
    Check for known vulnerabilities in a given service version.

    :param service_name: Name of the service (e.g., 'nginx')
    :param version: Version of the service (e.g., '1.18.0')
    :return: List of vulnerabilities found
    """
    # Example: Fetch data from the CVE website (or use an API like NVD)
    url = f"https://www.cvedetails.com/version-search.php?product={service_name}&version={version}"
    response = requests.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')

    vulnerabilities = []
    # Parse the HTML to extract CVE IDs and descriptions (simplified example)
    for row in soup.find_all('tr', class_='srrowns'):
        cve_id = row.find('td', class_='cvesummarylong').text.strip()
        vulnerabilities.append(cve_id)
    
    return vulnerabilities

if __name__ == "__main__":
    service_name = input("Enter the service name (e.g., 'nginx'): ")
    version = input("Enter the service version (e.g., '1.18.0'): ")
    vulns = check_vulnerability(service_name, version)
    print("Vulnerabilities Found:", vulns)
